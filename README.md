# تمرین دستگرمی سوم – پروژه نقاشی بکش لوئی :)

در این مرحله از پروژه نقاشی، قابلیت‌های ذخیره‌سازی و بازیابی نقاشی‌ها (چه روی سرور و چه به‌صورت فایل محلی) به ابزار اولیه‌ی نقاشی اضافه شده است. تمرکز این مرحله بر توسعه‌ی سیستمی برای نگهداری نقاشی‌ها در حافظه‌ی دائمی (فایل یا بک‌اند) و تعامل با آن از طریق رابط کاربری است.

## ساختار پروژه 
(ساختار فولدر paint یا به عبارتی بخش فرانت‌ در تمرین قبلی آمده است.)

```
.
├── paint/                # پروژه فرانت‌اند (Vite + React + TypeScript)
│   └── src/
│       └── api/
│           └── paintings.ts    # توابع ارتباط با API سرور
│       └── App.tsx             # کامپوننت اصلی پروژه با توابع ذخیره‌سازی و بارگذاری
│    ... (HH2)
└── server/               # پروژه بک‌اند (Node.js + Express)
    ├── server.js              # راه‌اندازی سرور
    ├── db.json                # دیتابیس ساده محلی برای ذخیره نقاشی‌ها
    ├── routes/
    │   └── paintings.js       # مسیرهای REST API برای مدیریت نقاشی‌ها
    └── package.json           # پکیج‌های npm و تنظیمات سرور
```

## بخش سرور (Node.js + Express)

پوشه `server/` شامل راه‌اندازی کامل یک سرور Express برای ارائه REST API است.

### server.js
- راه‌اندازی سرور روی پورت `3001`
- تنظیم CORS و body-parser برای دریافت JSON
- اتصال به مسیر `/api/paintings`

### routes/paintings.js
مدیریت مسیرهای API برای انجام عملیات CRUD روی نقاشی‌ها:
- `GET /api/paintings` → دریافت لیست نقاشی‌ها
- `POST /api/paintings` → ذخیره نقاشی جدید
- `PUT /api/paintings/:id` → بروزرسانی نقاشی
- `DELETE /api/paintings/:id` → حذف نقاشی

از پکیج `uuid` برای تولید شناسه‌های یکتا استفاده شده.

### db.json
فایلی ساده برای نگهداری داده‌ها به صورت محلی (جایگزین دیتابیس).

### package.json
پکیج‌های مورد نیاز:
- `express`
- `cors`
- `body-parser`
- `uuid`

## API فرانت‌اند – `paint/src/api/paintings.ts`

این فایل شامل توابع ارتباط با سرور با استفاده از `fetch` است:

```ts
getPaintings()           // دریافت لیست نقاشی‌ها
savePainting(data)       // ذخیره نقاشی جدید
updatePainting(id, data) // بروزرسانی نقاشی موجود
deletePainting(id)       // حذف نقاشی خاص
```

سایر کامپوننت‌ها از این توابع برای ارتباط با سرور استفاده می‌کنند.

## تغییرات در فایل `App.tsx`

کامپوننت اصلی پروژه با چند تابع جدید گسترش یافته است:

### handleSave
ذخیره‌ی نقاشی فعلی روی سرور با فیلدهای:
- `title`, `userName`, `createdAt`, `boardData`

استفاده از تابع `savePainting()` برای ارسال داده‌ها.

### handleLoad
بارگذاری آخرین نقاشی ذخیره‌شده با:
- فراخوانی `getPaintings()`
- اعمال آخرین نقاشی روی بورد

### handleExport
ذخیره نقاشی فعلی به‌صورت فایل `.json`:
- ساخت فایل با `Blob`
- نام‌گذاری بر اساس `title`

### handleImport
بارگذاری نقاشی از فایل JSON محلی:
- انتخاب فایل توسط کاربر
- خواندن محتوا با `FileReader` و اعمال روی بورد

## فرمت داده‌ی نقاشی

ساختار هر نقاشی به صورت زیر است:

```ts
{
  id: string,          
  userName: string,    
  title: string,       
  createdAt: string,   
  boardData: Shape[]   
}
```

## نحوه اجرا

### اجرای سرور:
```bash
cd server
npm install
node server.js
```

### اجرای فرانت‌اند:
```bash
cd paint
npm install
npm run dev
```

سپس پروژه را در مرورگر باز کنید:
```
http://localhost:5173
```

## جمع بندی

در این مرحله، با افزودن بخش سرور، API ارتباط با بک‌اند، و توابع مدیریت فایل، پروژه از یک ابزار ساده‌ی نقاشی به یک سیستم کامل با قابلیت ذخیره‌سازی  و تعامل فایل‌محور ارتقا یافته است. قابلیت export/import فایل نیز امکان تعامل با داده‌ها خارج از مرورگر را فراهم کرده است.

## پی‌نوشت
برای اتصال فرانت‌اند به بک‌اند از GPT کمک گرفتم ولی موفقیت‌آمیز نبود و باگ‌هایی به ‌نظر وجود داره.‌